"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.clearSession = exports.storeSession = exports.getStoredSession = exports.SESSION = exports.storage = void 0;
const terra_js_1 = require("@terra-money/terra.js");
exports.storage = typeof window === 'undefined' ? undefined : localStorage;
exports.SESSION = '__terra_chrome_extension_session__';
function getStoredSession() {
    const data = exports.storage === null || exports.storage === void 0 ? void 0 : exports.storage.getItem(exports.SESSION);
    if (!data) {
        return undefined;
    }
    try {
        const object = JSON.parse(data);
        if ('identifier' in object &&
            'walletAddress' in object &&
            terra_js_1.AccAddress.validate(object['walletAddress'])) {
            return {
                identifier: object['identifier'],
                walletAddress: object['walletAddress'],
            };
        }
        else {
            exports.storage === null || exports.storage === void 0 ? void 0 : exports.storage.removeItem(exports.SESSION);
            return undefined;
        }
    }
    catch (_a) {
        exports.storage === null || exports.storage === void 0 ? void 0 : exports.storage.removeItem(exports.SESSION);
        return undefined;
    }
}
exports.getStoredSession = getStoredSession;
function storeSession(session) {
    if (!terra_js_1.AccAddress.validate(session.walletAddress)) {
        throw new Error(`${session.walletAddress} is invalid terra address!`);
    }
    exports.storage === null || exports.storage === void 0 ? void 0 : exports.storage.setItem(exports.SESSION, JSON.stringify(session));
}
exports.storeSession = storeSession;
function clearSession() {
    exports.storage === null || exports.storage === void 0 ? void 0 : exports.storage.removeItem(exports.SESSION);
}
exports.clearSession = clearSession;
//export function getStoredAddress(): string | null {
//  const address = storage?.getItem(WALLET_ADDRESS);
//  return address && AccAddress.validate(address) ? address : null;
//}
//
//export function storeAddress(address: string) {
//  if (!AccAddress.validate(address)) {
//    throw new Error(`${address} is invalidate terra address!`);
//  }
//
//  storage && storage.setItem(WALLET_ADDRESS, address);
//}
//
//export function clearStore() {
//  storage && storage.removeItem(WALLET_ADDRESS);
//}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmFnZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9AdGVycmEtZGV2L2Nocm9tZS1leHRlbnNpb24vc3RvcmFnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxvREFBbUQ7QUFFdEMsUUFBQSxPQUFPLEdBQUcsT0FBTyxNQUFNLEtBQUssV0FBVyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQztBQVVuRSxRQUFBLE9BQU8sR0FBVyxvQ0FBb0MsQ0FBQztBQUVwRSxTQUFnQixnQkFBZ0I7SUFDOUIsTUFBTSxJQUFJLEdBQUcsZUFBTyxhQUFQLGVBQU8sdUJBQVAsZUFBTyxDQUFFLE9BQU8sQ0FBQyxlQUFPLENBQUMsQ0FBQztJQUV2QyxJQUFJLENBQUMsSUFBSSxFQUFFO1FBQ1QsT0FBTyxTQUFTLENBQUM7S0FDbEI7SUFFRCxJQUFJO1FBQ0YsTUFBTSxNQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVoQyxJQUNFLFlBQVksSUFBSSxNQUFNO1lBQ3RCLGVBQWUsSUFBSSxNQUFNO1lBQ3pCLHFCQUFVLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxlQUFlLENBQUMsQ0FBQyxFQUM1QztZQUNBLE9BQU87Z0JBQ0wsVUFBVSxFQUFFLE1BQU0sQ0FBQyxZQUFZLENBQUM7Z0JBQ2hDLGFBQWEsRUFBRSxNQUFNLENBQUMsZUFBZSxDQUFDO2FBQ3ZDLENBQUM7U0FDSDthQUFNO1lBQ0wsZUFBTyxhQUFQLGVBQU8sdUJBQVAsZUFBTyxDQUFFLFVBQVUsQ0FBQyxlQUFPLENBQUMsQ0FBQztZQUM3QixPQUFPLFNBQVMsQ0FBQztTQUNsQjtLQUNGO0lBQUMsV0FBTTtRQUNOLGVBQU8sYUFBUCxlQUFPLHVCQUFQLGVBQU8sQ0FBRSxVQUFVLENBQUMsZUFBTyxDQUFDLENBQUM7UUFDN0IsT0FBTyxTQUFTLENBQUM7S0FDbEI7QUFDSCxDQUFDO0FBM0JELDRDQTJCQztBQUVELFNBQWdCLFlBQVksQ0FBQyxPQUFnQjtJQUMzQyxJQUFJLENBQUMscUJBQVUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxFQUFFO1FBQy9DLE1BQU0sSUFBSSxLQUFLLENBQUMsR0FBRyxPQUFPLENBQUMsYUFBYSw0QkFBNEIsQ0FBQyxDQUFDO0tBQ3ZFO0lBRUQsZUFBTyxhQUFQLGVBQU8sdUJBQVAsZUFBTyxDQUFFLE9BQU8sQ0FBQyxlQUFPLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0FBQ3JELENBQUM7QUFORCxvQ0FNQztBQUVELFNBQWdCLFlBQVk7SUFDMUIsZUFBTyxhQUFQLGVBQU8sdUJBQVAsZUFBTyxDQUFFLFVBQVUsQ0FBQyxlQUFPLENBQUMsQ0FBQztBQUMvQixDQUFDO0FBRkQsb0NBRUM7QUFFRCxxREFBcUQ7QUFDckQscURBQXFEO0FBQ3JELG9FQUFvRTtBQUNwRSxHQUFHO0FBQ0gsRUFBRTtBQUNGLGlEQUFpRDtBQUNqRCx3Q0FBd0M7QUFDeEMsaUVBQWlFO0FBQ2pFLEtBQUs7QUFDTCxFQUFFO0FBQ0Ysd0RBQXdEO0FBQ3hELEdBQUc7QUFDSCxFQUFFO0FBQ0YsZ0NBQWdDO0FBQ2hDLGtEQUFrRDtBQUNsRCxHQUFHIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWNjQWRkcmVzcyB9IGZyb20gJ0B0ZXJyYS1tb25leS90ZXJyYS5qcyc7XG5cbmV4cG9ydCBjb25zdCBzdG9yYWdlID0gdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcgPyB1bmRlZmluZWQgOiBsb2NhbFN0b3JhZ2U7XG5cbi8vZXhwb3J0IGNvbnN0IFdBTExFVF9BRERSRVNTOiBzdHJpbmcgPVxuLy8gICdfX3RlcnJhX2Nocm9tZV9leHRlbnNpb25fd2FsbGV0X2FkZHJlc3NfXyc7XG5cbmludGVyZmFjZSBTZXNzaW9uIHtcbiAgaWRlbnRpZmllcjogc3RyaW5nO1xuICB3YWxsZXRBZGRyZXNzOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBTRVNTSU9OOiBzdHJpbmcgPSAnX190ZXJyYV9jaHJvbWVfZXh0ZW5zaW9uX3Nlc3Npb25fXyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRTdG9yZWRTZXNzaW9uKCk6IFNlc3Npb24gfCB1bmRlZmluZWQge1xuICBjb25zdCBkYXRhID0gc3RvcmFnZT8uZ2V0SXRlbShTRVNTSU9OKTtcblxuICBpZiAoIWRhdGEpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBvYmplY3QgPSBKU09OLnBhcnNlKGRhdGEpO1xuXG4gICAgaWYgKFxuICAgICAgJ2lkZW50aWZpZXInIGluIG9iamVjdCAmJlxuICAgICAgJ3dhbGxldEFkZHJlc3MnIGluIG9iamVjdCAmJlxuICAgICAgQWNjQWRkcmVzcy52YWxpZGF0ZShvYmplY3RbJ3dhbGxldEFkZHJlc3MnXSlcbiAgICApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkZW50aWZpZXI6IG9iamVjdFsnaWRlbnRpZmllciddLFxuICAgICAgICB3YWxsZXRBZGRyZXNzOiBvYmplY3RbJ3dhbGxldEFkZHJlc3MnXSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0b3JhZ2U/LnJlbW92ZUl0ZW0oU0VTU0lPTik7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSBjYXRjaCB7XG4gICAgc3RvcmFnZT8ucmVtb3ZlSXRlbShTRVNTSU9OKTtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdG9yZVNlc3Npb24oc2Vzc2lvbjogU2Vzc2lvbikge1xuICBpZiAoIUFjY0FkZHJlc3MudmFsaWRhdGUoc2Vzc2lvbi53YWxsZXRBZGRyZXNzKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtzZXNzaW9uLndhbGxldEFkZHJlc3N9IGlzIGludmFsaWQgdGVycmEgYWRkcmVzcyFgKTtcbiAgfVxuXG4gIHN0b3JhZ2U/LnNldEl0ZW0oU0VTU0lPTiwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJTZXNzaW9uKCkge1xuICBzdG9yYWdlPy5yZW1vdmVJdGVtKFNFU1NJT04pO1xufVxuXG4vL2V4cG9ydCBmdW5jdGlvbiBnZXRTdG9yZWRBZGRyZXNzKCk6IHN0cmluZyB8IG51bGwge1xuLy8gIGNvbnN0IGFkZHJlc3MgPSBzdG9yYWdlPy5nZXRJdGVtKFdBTExFVF9BRERSRVNTKTtcbi8vICByZXR1cm4gYWRkcmVzcyAmJiBBY2NBZGRyZXNzLnZhbGlkYXRlKGFkZHJlc3MpID8gYWRkcmVzcyA6IG51bGw7XG4vL31cbi8vXG4vL2V4cG9ydCBmdW5jdGlvbiBzdG9yZUFkZHJlc3MoYWRkcmVzczogc3RyaW5nKSB7XG4vLyAgaWYgKCFBY2NBZGRyZXNzLnZhbGlkYXRlKGFkZHJlc3MpKSB7XG4vLyAgICB0aHJvdyBuZXcgRXJyb3IoYCR7YWRkcmVzc30gaXMgaW52YWxpZGF0ZSB0ZXJyYSBhZGRyZXNzIWApO1xuLy8gIH1cbi8vXG4vLyAgc3RvcmFnZSAmJiBzdG9yYWdlLnNldEl0ZW0oV0FMTEVUX0FERFJFU1MsIGFkZHJlc3MpO1xuLy99XG4vL1xuLy9leHBvcnQgZnVuY3Rpb24gY2xlYXJTdG9yZSgpIHtcbi8vICBzdG9yYWdlICYmIHN0b3JhZ2UucmVtb3ZlSXRlbShXQUxMRVRfQUREUkVTUyk7XG4vL31cbiJdfQ==