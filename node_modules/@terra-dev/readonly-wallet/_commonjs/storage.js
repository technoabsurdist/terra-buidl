"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.clearStoredSession = exports.storeSession = exports.getStoredSession = void 0;
const terra_js_1 = require("@terra-money/terra.js");
const STORAGE_KEY = '__terra-readonly-wallet-storage-key__';
function getStoredSession() {
    const storedSessionString = localStorage.getItem(STORAGE_KEY);
    if (!storedSessionString)
        return undefined;
    try {
        const storedSession = JSON.parse(storedSessionString);
        if ('terraAddress' in storedSession &&
            'network' in storedSession &&
            typeof storedSession['terraAddress'] === 'string' &&
            terra_js_1.AccAddress.validate(storedSession.terraAddress)) {
            return storedSession;
        }
        else {
            localStorage.removeItem(STORAGE_KEY);
            return undefined;
        }
    }
    catch (_a) {
        localStorage.removeItem(STORAGE_KEY);
        return undefined;
    }
}
exports.getStoredSession = getStoredSession;
function storeSession(session) {
    if (!terra_js_1.AccAddress.validate(session.terraAddress)) {
        throw new Error(`${session.terraAddress} is not a terraAddress`);
    }
    localStorage.setItem(STORAGE_KEY, JSON.stringify(session));
}
exports.storeSession = storeSession;
function clearStoredSession() {
    localStorage.removeItem(STORAGE_KEY);
}
exports.clearStoredSession = clearStoredSession;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RvcmFnZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9AdGVycmEtZGV2L3JlYWRvbmx5LXdhbGxldC9zdG9yYWdlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG9EQUFtRDtBQUduRCxNQUFNLFdBQVcsR0FBRyx1Q0FBdUMsQ0FBQztBQUU1RCxTQUFnQixnQkFBZ0I7SUFDOUIsTUFBTSxtQkFBbUIsR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBRTlELElBQUksQ0FBQyxtQkFBbUI7UUFBRSxPQUFPLFNBQVMsQ0FBQztJQUUzQyxJQUFJO1FBQ0YsTUFBTSxhQUFhLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO1FBRXRELElBQ0UsY0FBYyxJQUFJLGFBQWE7WUFDL0IsU0FBUyxJQUFJLGFBQWE7WUFDMUIsT0FBTyxhQUFhLENBQUMsY0FBYyxDQUFDLEtBQUssUUFBUTtZQUNqRCxxQkFBVSxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLEVBQy9DO1lBQ0EsT0FBTyxhQUFhLENBQUM7U0FDdEI7YUFBTTtZQUNMLFlBQVksQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDckMsT0FBTyxTQUFTLENBQUM7U0FDbEI7S0FDRjtJQUFDLFdBQU07UUFDTixZQUFZLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1FBQ3JDLE9BQU8sU0FBUyxDQUFDO0tBQ2xCO0FBQ0gsQ0FBQztBQXZCRCw0Q0F1QkM7QUFFRCxTQUFnQixZQUFZLENBQUMsT0FBOEI7SUFDekQsSUFBSSxDQUFDLHFCQUFVLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsRUFBRTtRQUM5QyxNQUFNLElBQUksS0FBSyxDQUFDLEdBQUcsT0FBTyxDQUFDLFlBQVksd0JBQXdCLENBQUMsQ0FBQztLQUNsRTtJQUNELFlBQVksQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUM3RCxDQUFDO0FBTEQsb0NBS0M7QUFFRCxTQUFnQixrQkFBa0I7SUFDaEMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBRkQsZ0RBRUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBY2NBZGRyZXNzIH0gZnJvbSAnQHRlcnJhLW1vbmV5L3RlcnJhLmpzJztcbmltcG9ydCB7IFJlYWRvbmx5V2FsbGV0U2Vzc2lvbiB9IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBTVE9SQUdFX0tFWSA9ICdfX3RlcnJhLXJlYWRvbmx5LXdhbGxldC1zdG9yYWdlLWtleV9fJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFN0b3JlZFNlc3Npb24oKTogUmVhZG9ubHlXYWxsZXRTZXNzaW9uIHwgdW5kZWZpbmVkIHtcbiAgY29uc3Qgc3RvcmVkU2Vzc2lvblN0cmluZyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFNUT1JBR0VfS0VZKTtcblxuICBpZiAoIXN0b3JlZFNlc3Npb25TdHJpbmcpIHJldHVybiB1bmRlZmluZWQ7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBzdG9yZWRTZXNzaW9uID0gSlNPTi5wYXJzZShzdG9yZWRTZXNzaW9uU3RyaW5nKTtcblxuICAgIGlmIChcbiAgICAgICd0ZXJyYUFkZHJlc3MnIGluIHN0b3JlZFNlc3Npb24gJiZcbiAgICAgICduZXR3b3JrJyBpbiBzdG9yZWRTZXNzaW9uICYmXG4gICAgICB0eXBlb2Ygc3RvcmVkU2Vzc2lvblsndGVycmFBZGRyZXNzJ10gPT09ICdzdHJpbmcnICYmXG4gICAgICBBY2NBZGRyZXNzLnZhbGlkYXRlKHN0b3JlZFNlc3Npb24udGVycmFBZGRyZXNzKVxuICAgICkge1xuICAgICAgcmV0dXJuIHN0b3JlZFNlc3Npb247XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFNUT1JBR0VfS0VZKTtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICB9IGNhdGNoIHtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShTVE9SQUdFX0tFWSk7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RvcmVTZXNzaW9uKHNlc3Npb246IFJlYWRvbmx5V2FsbGV0U2Vzc2lvbikge1xuICBpZiAoIUFjY0FkZHJlc3MudmFsaWRhdGUoc2Vzc2lvbi50ZXJyYUFkZHJlc3MpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGAke3Nlc3Npb24udGVycmFBZGRyZXNzfSBpcyBub3QgYSB0ZXJyYUFkZHJlc3NgKTtcbiAgfVxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShTVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkoc2Vzc2lvbikpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJTdG9yZWRTZXNzaW9uKCkge1xuICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShTVE9SQUdFX0tFWSk7XG59XG4iXX0=