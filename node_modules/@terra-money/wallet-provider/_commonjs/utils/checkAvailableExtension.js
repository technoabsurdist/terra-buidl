"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkAvailableExtension = void 0;
const use_wallet_1 = require("@terra-dev/use-wallet");
const interval = 500;
async function checkAvailableExtension(timeout, isChromeExtensionCompatibleBrowser) {
    return new Promise((resolve) => {
        if (isChromeExtensionCompatibleBrowser) {
            resolve(use_wallet_1.ConnectType.CHROME_EXTENSION);
            return;
        }
        const start = Date.now();
        function check() {
            const meta = window.document.querySelector('head > meta[name="terra-web-connect"]');
            if (typeof (meta === null || meta === void 0 ? void 0 : meta.getAttribute('connected')) === 'string') {
                resolve(use_wallet_1.ConnectType.WEB_CONNECT);
            }
            else if (window['isTerraExtensionAvailable'] === true) {
                resolve(use_wallet_1.ConnectType.CHROME_EXTENSION);
            }
            else if (Date.now() > start + timeout) {
                resolve(null);
            }
            else {
                setTimeout(check, interval);
            }
        }
        setTimeout(check, interval);
    });
}
exports.checkAvailableExtension = checkAvailableExtension;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hlY2tBdmFpbGFibGVFeHRlbnNpb24uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvQHRlcnJhLW1vbmV5L3dhbGxldC1wcm92aWRlci91dGlscy9jaGVja0F2YWlsYWJsZUV4dGVuc2lvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxzREFBb0Q7QUFFcEQsTUFBTSxRQUFRLEdBQUcsR0FBRyxDQUFDO0FBRWQsS0FBSyxVQUFVLHVCQUF1QixDQUMzQyxPQUFlLEVBQ2Ysa0NBQTJDO0lBRTNDLE9BQU8sSUFBSSxPQUFPLENBRWhCLENBQUMsT0FBTyxFQUFFLEVBQUU7UUFDWixJQUFJLGtDQUFrQyxFQUFFO1lBQ3RDLE9BQU8sQ0FBQyx3QkFBVyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDdEMsT0FBTztTQUNSO1FBRUQsTUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBRXpCLFNBQVMsS0FBSztZQUNaLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUN4Qyx1Q0FBdUMsQ0FDeEMsQ0FBQztZQUVGLElBQUksT0FBTyxDQUFBLElBQUksYUFBSixJQUFJLHVCQUFKLElBQUksQ0FBRSxZQUFZLENBQUMsV0FBVyxDQUFDLENBQUEsS0FBSyxRQUFRLEVBQUU7Z0JBQ3ZELE9BQU8sQ0FBQyx3QkFBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDO2FBQ2xDO2lCQUFNLElBQUksTUFBTSxDQUFDLDJCQUEyQixDQUFDLEtBQUssSUFBSSxFQUFFO2dCQUN2RCxPQUFPLENBQUMsd0JBQVcsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO2FBQ3ZDO2lCQUFNLElBQUksSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLEtBQUssR0FBRyxPQUFPLEVBQUU7Z0JBQ3ZDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUNmO2lCQUFNO2dCQUNMLFVBQVUsQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7YUFDN0I7UUFDSCxDQUFDO1FBRUQsVUFBVSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztJQUM5QixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFoQ0QsMERBZ0NDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29ubmVjdFR5cGUgfSBmcm9tICdAdGVycmEtZGV2L3VzZS13YWxsZXQnO1xuXG5jb25zdCBpbnRlcnZhbCA9IDUwMDtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrQXZhaWxhYmxlRXh0ZW5zaW9uKFxuICB0aW1lb3V0OiBudW1iZXIsXG4gIGlzQ2hyb21lRXh0ZW5zaW9uQ29tcGF0aWJsZUJyb3dzZXI6IGJvb2xlYW4sXG4pOiBQcm9taXNlPENvbm5lY3RUeXBlLkNIUk9NRV9FWFRFTlNJT04gfCBDb25uZWN0VHlwZS5XRUJfQ09OTkVDVCB8IG51bGw+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlPFxuICAgIENvbm5lY3RUeXBlLkNIUk9NRV9FWFRFTlNJT04gfCBDb25uZWN0VHlwZS5XRUJfQ09OTkVDVCB8IG51bGxcbiAgPigocmVzb2x2ZSkgPT4ge1xuICAgIGlmIChpc0Nocm9tZUV4dGVuc2lvbkNvbXBhdGlibGVCcm93c2VyKSB7XG4gICAgICByZXNvbHZlKENvbm5lY3RUeXBlLkNIUk9NRV9FWFRFTlNJT04pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcblxuICAgIGZ1bmN0aW9uIGNoZWNrKCkge1xuICAgICAgY29uc3QgbWV0YSA9IHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAnaGVhZCA+IG1ldGFbbmFtZT1cInRlcnJhLXdlYi1jb25uZWN0XCJdJyxcbiAgICAgICk7XG5cbiAgICAgIGlmICh0eXBlb2YgbWV0YT8uZ2V0QXR0cmlidXRlKCdjb25uZWN0ZWQnKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmVzb2x2ZShDb25uZWN0VHlwZS5XRUJfQ09OTkVDVCk7XG4gICAgICB9IGVsc2UgaWYgKHdpbmRvd1snaXNUZXJyYUV4dGVuc2lvbkF2YWlsYWJsZSddID09PSB0cnVlKSB7XG4gICAgICAgIHJlc29sdmUoQ29ubmVjdFR5cGUuQ0hST01FX0VYVEVOU0lPTik7XG4gICAgICB9IGVsc2UgaWYgKERhdGUubm93KCkgPiBzdGFydCArIHRpbWVvdXQpIHtcbiAgICAgICAgcmVzb2x2ZShudWxsKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFRpbWVvdXQoY2hlY2ssIGludGVydmFsKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRUaW1lb3V0KGNoZWNrLCBpbnRlcnZhbCk7XG4gIH0pO1xufVxuIl19